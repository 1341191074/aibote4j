# ç¯å¢ƒå®‰è£…æŒ‡å—

## ğŸ“‹ ç›®å½•

- [ç³»ç»Ÿè¦æ±‚](#ç³»ç»Ÿè¦æ±‚)
- [å¼€å‘ç¯å¢ƒå®‰è£…](#å¼€å‘ç¯å¢ƒå®‰è£…)
- [é¡¹ç›®ç¼–è¯‘](#é¡¹ç›®ç¼–è¯‘)
- [é…ç½®ç®¡ç†](#é…ç½®ç®¡ç†)
- [ç¬¬ä¸€æ¬¡è¿è¡Œ](#ç¬¬ä¸€æ¬¡è¿è¡Œ)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

## ğŸ“¦ ç³»ç»Ÿè¦æ±‚

### å¿…éœ€æ¡ä»¶

| ç»„ä»¶ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| **Java** | 21+ | æ ¸å¿ƒè¿è¡Œç¯å¢ƒ |
| **Maven** | 3.8+ | é¡¹ç›®æ„å»ºå·¥å…· |
| **Git** | æœ€æ–° | ç‰ˆæœ¬æ§åˆ¶ |

### æ“ä½œç³»ç»Ÿæ”¯æŒ

- âœ… Windows 10/11
- âœ… macOS 10.15+
- âœ… Linux (Ubuntu 20.04+)

### å¯é€‰å·¥å…·

- IDE: IntelliJ IDEA, Eclipse æˆ– VS Code
- æ•°æ®åº“: MySQL 8.0+ (å¯é€‰ï¼Œç”¨äºé…ç½®æŒä¹…åŒ–)

## ğŸš€ å¼€å‘ç¯å¢ƒå®‰è£…

### Windows ç³»ç»Ÿ

#### 1. å®‰è£… Java 21

```bash
# ä½¿ç”¨ Chocolatey å®‰è£…ï¼ˆæ¨èï¼‰
choco install openjdk21

# éªŒè¯å®‰è£…
java -version

# é¢„æœŸè¾“å‡º
# openjdk version "21.x.x" ...
```

#### 2. å®‰è£… Maven

```bash
# ä½¿ç”¨ Chocolatey
choco install maven

# éªŒè¯å®‰è£…
mvn -version

# é¢„æœŸè¾“å‡º
# Apache Maven 3.8.x ...
# Java version: 21.x.x ...
```

#### 3. é…ç½®ç¯å¢ƒå˜é‡

```bash
# è®¾ç½® JAVA_HOME
setx JAVA_HOME "C:\Program Files\Java\jdk-21"

# è®¾ç½® MAVEN_HOME  
setx MAVEN_HOME "C:\Program Files\maven"

# æ›´æ–° PATH
setx PATH "%PATH%;%JAVA_HOME%\bin;%MAVEN_HOME%\bin"

# é‡å¯å‘½ä»¤è¡Œï¼ŒéªŒè¯
java -version
mvn -version
```

### macOS ç³»ç»Ÿ

```bash
# ä½¿ç”¨ Homebrew å®‰è£…
brew install openjdk@21
brew install maven

# éªŒè¯
java -version
mvn -version

# é…ç½®ç¯å¢ƒå˜é‡ï¼ˆå¦‚éœ€è¦ï¼‰
# ç¼–è¾‘ ~/.zshrc æˆ– ~/.bash_profile
export JAVA_HOME=$(/usr/libexec/java_home -v 21)
export PATH="$JAVA_HOME/bin:$PATH"
```

### Linux ç³»ç»Ÿ

```bash
# Ubuntu/Debian
sudo apt-get update
sudo apt-get install openjdk-21-jdk maven

# CentOS/RHEL
sudo yum install java-21-openjdk java-21-openjdk-devel maven

# éªŒè¯
java -version
mvn -version
```

## ğŸ”§ é¡¹ç›®ç¼–è¯‘

### å…‹éš†é¡¹ç›®

```bash
# å…‹éš†ä¸»åˆ†æ”¯
git clone https://github.com/aibote/aibote4j.git
cd aibote4j

# æˆ–å…‹éš†ç‰¹å®šåˆ†æ”¯
git clone -b develop https://github.com/aibote/aibote4j.git
```

### ç¼–è¯‘é€‰é¡¹

```bash
# 1. æ ‡å‡†ç¼–è¯‘ï¼ˆæ¨èï¼‰
mvn clean compile

# 2. å¿«é€Ÿç¼–è¯‘ï¼ˆè·³è¿‡æµ‹è¯•ï¼‰
mvn clean compile -DskipTests

# 3. å®Œæ•´ç¼–è¯‘ï¼ˆåŒ…å«æµ‹è¯•ï¼‰
mvn clean install

# 4. ç”Ÿæˆå¯æ‰§è¡Œ JAR
mvn clean package

# 5. è·³è¿‡æ‰€æœ‰å¯é€‰æ’ä»¶
mvn clean compile -o

# 6. å¤šçº¿ç¨‹ç¼–è¯‘ï¼ˆåŠ å¿«é€Ÿåº¦ï¼‰
mvn clean compile -T 1C
```

### éªŒè¯ç¼–è¯‘ç»“æœ

```bash
# æ£€æŸ¥ç”Ÿæˆçš„ target ç›®å½•
ls target/

# é¢„æœŸæ–‡ä»¶
# - classes/          # ç¼–è¯‘åçš„ç±»æ–‡ä»¶
# - generated-sources/ # ç”Ÿæˆçš„ä»£ç 
# - maven-status/     # ç¼–è¯‘çŠ¶æ€ä¿¡æ¯
```

## âš™ï¸ é…ç½®ç®¡ç†

### é…ç½®æ–‡ä»¶ä½ç½®

```
sdk-common/src/main/resources/
â”œâ”€â”€ bot-config.yml      # æœºå™¨äººé…ç½®
â””â”€â”€ logback.xml        # æ—¥å¿—é…ç½®ï¼ˆå¯é€‰ï¼‰
```

### æœºå™¨äººé…ç½®ï¼ˆbot-config.ymlï¼‰

```yaml
# æœåŠ¡å™¨é…ç½®
server:
  ip: "127.0.0.1"
  port: 9527
  timeout: 30000

# é€šä¿¡é…ç½®
communication:
  responseTimeout: 10000      # å“åº”è¶…æ—¶
  delayResponseTimeout: 30000 # å»¶è¿Ÿå“åº”è¶…æ—¶
  poolSize: 10                # è¿æ¥æ± å¤§å°

# æ—¥å¿—é…ç½®
logging:
  level: INFO
  pattern: "%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"

# ç¼“å­˜é…ç½®
cache:
  enabled: true
  ttl: 3600           # ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
  maxSize: 1000       # æœ€å¤§ç¼“å­˜æ•°
```

### è¿è¡Œæ—¶é…ç½®

```java
// è¯»å–é…ç½®
ConfigManager configManager = ConfigManager.getInstance();
CommunicationConfig config = configManager.getCommunicationConfig();

// è·å–é…ç½®å€¼
int timeout = config.getResponseTimeout();
String serverIp = config.getServerIp();

// åŠ¨æ€è®¾ç½®ï¼ˆå¦‚éœ€è¦ï¼‰
config.setResponseTimeout(15000);
```

## ğŸ¯ ç¬¬ä¸€æ¬¡è¿è¡Œ

### 1. éªŒè¯ç¯å¢ƒ

```bash
# ç¡®è®¤ Java ç‰ˆæœ¬
java -version

# ç¡®è®¤ Maven ç‰ˆæœ¬
mvn -version

# æ£€æŸ¥ Git å®‰è£…
git --version
```

### 2. ç¼–è¯‘é¡¹ç›®

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd aibote4j

# æ¸…ç†å¹¶ç¼–è¯‘
mvn clean compile -DskipTests

# é¢„æœŸè¾“å‡º
# [INFO] BUILD SUCCESS
```

### 3. è¿è¡Œç¤ºä¾‹

```bash
# è¿è¡Œ Windows è‡ªåŠ¨åŒ–ç¤ºä¾‹
mvn exec:java -Dexec.mainClass="net.aibote.examples.WinBotExample"

# æˆ–ç¼–è¯‘åè¿è¡Œ
cd sdk-server
mvn spring-boot:run
```

### 4. æ£€æŸ¥è¿æ¥

```java
// åˆ›å»ºç®€å•æµ‹è¯•
WinBot bot = BotFactory.builder()
    .withBotType(BotFactory.BotType.WIN)
    .build();

// æ³¨å†Œå¹¶å¯åŠ¨ä»»åŠ¡
NotepadAutomationTask task = NotepadAutomationTask.builder()
    .taskName("ç¯å¢ƒæµ‹è¯•ä»»åŠ¡")
    .scriptName("Env-Test")
    .build();

String taskId = TaskEngine.getInstance().registerTask("env-test", task);
System.out.println("ä»»åŠ¡æ³¨å†ŒæˆåŠŸï¼ŒID: " + taskId);

// å¯åŠ¨æœåŠ¡ç«¯ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥
Application.main(new String[]{});
```

## ğŸ› å¸¸è§é—®é¢˜

### Q1: Maven ç¼–è¯‘å¤±è´¥ï¼Œé”™è¯¯ä¸º "Unknown class file version"

**åŸå› **ï¼šJava ç‰ˆæœ¬è¿‡ä½

**è§£å†³**ï¼š
```bash
# æ£€æŸ¥ Java ç‰ˆæœ¬
java -version

# åº”è¯¥æ˜¾ç¤º 21.x.x æˆ–æ›´é«˜
# å¦‚æœç‰ˆæœ¬ä½äº 21ï¼Œå‡çº§ Java
```

### Q2: ç¼–è¯‘æ—¶æŠ¥ "No JDK found"

**åŸå› **ï¼šMaven æ‰¾ä¸åˆ° JDK

**è§£å†³**ï¼š
```bash
# è®¾ç½® JAVA_HOME
export JAVA_HOME=/path/to/jdk-21  # Linux/macOS
setx JAVA_HOME "C:\Program Files\Java\jdk-21"  # Windows

# éªŒè¯
echo $JAVA_HOME

# é‡æ–°ç¼–è¯‘
mvn clean compile
```

### Q3: ç½‘ç»œè¿æ¥å¤±è´¥

**åŸå› **ï¼šè¿æ¥å‚æ•°é”™è¯¯æˆ–ç›®æ ‡ä¸å¯è¾¾

**è§£å†³**ï¼š
```bash
# æ£€æŸ¥é…ç½®
cat sdk-common/src/main/resources/bot-config.yml

# æµ‹è¯•ç½‘ç»œè¿æ¥
ping 127.0.0.1

# æ£€æŸ¥é˜²ç«å¢™
# ç¡®ä¿ç«¯å£ 9527 æœªè¢«é˜»æ­¢
```

### Q4: å†…å­˜ä¸è¶³ (OutOfMemoryError)

**åŸå› **ï¼šJVM å†…å­˜åˆ†é…ä¸è¶³

**è§£å†³**ï¼š
```bash
# å¢åŠ  Maven å†…å­˜
export MAVEN_OPTS="-Xmx1024m -Xms512m"

# æˆ–åœ¨ pom.xml ä¸­é…ç½®
<maven.compiler.source>21</maven.compiler.source>
<maven.compiler.target>21</maven.compiler.target>
```

### Q5: ç¼–è¯‘æˆåŠŸä½†æ— æ³•è¿è¡Œ

**åŸå› **ï¼šä¾èµ–æœªä¸‹è½½æˆ–è·¯å¾„é”™è¯¯

**è§£å†³**ï¼š
```bash
# æ¸…ç†ç¼“å­˜å¹¶é‡æ–°ä¸‹è½½ä¾èµ–
mvn clean dependency:resolve

# æ£€æŸ¥ä¾èµ–
mvn dependency:tree

# é‡æ–°ç¼–è¯‘
mvn clean compile
```

## ğŸ“š è¿›é˜¶é…ç½®

### è‡ªå®šä¹‰æ—¥å¿—é…ç½®

åˆ›å»º `logback.xml`ï¼š

```xml
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>
    
    <root level="INFO">
        <appender-ref ref="CONSOLE"/>
    </root>
</configuration>
```

### æœåŠ¡ç«¯é…ç½®

```java
// é…ç½®æœåŠ¡ç«¯ç›‘å¬åœ°å€
System.setProperty("server.host", "0.0.0.0");
System.setProperty("server.port", "16999");

// æ³¨å†Œè‡ªåŠ¨åŒ–ä»»åŠ¡
NotepadAutomationTask task = NotepadAutomationTask.builder()
    .taskName("è¿œç¨‹æœåŠ¡ä»»åŠ¡")
    .scriptName("Remote-Service")
    .build();

TaskEngine.getInstance().registerTask("remote-task", task);

// å¯åŠ¨æœåŠ¡ç«¯
Application.main(new String[]{});
```

### è¿æ¥æ± é…ç½®

```java
// åˆ›å»ºè¿æ¥æ± ç®¡ç†å™¨
ConnectionPoolManager poolManager = ConnectionPoolManager.getInstance();

// é…ç½®æ± å‚æ•°
poolManager.setPoolSize(20);
poolManager.setConnectionTimeout(5000);
poolManager.setIdleTimeout(300000);

// ç›‘æ§æ± çŠ¶æ€
System.out.println("æ´»è·ƒè¿æ¥: " + poolManager.getActiveConnections());
System.out.println("ç©ºé—²è¿æ¥: " + poolManager.getIdleConnections());
```

## âœ… å®‰è£…æ£€æŸ¥æ¸…å•

- [ ] Java 21+ å·²å®‰è£…
- [ ] Maven 3.8+ å·²å®‰è£…
- [ ] é¡¹ç›®å·²å…‹éš†
- [ ] é¡¹ç›®ç¼–è¯‘æˆåŠŸ
- [ ] ç¯å¢ƒå˜é‡å·²é…ç½®
- [ ] å¯ä»¥è¿è¡Œç¤ºä¾‹ä»£ç 
- [ ] å¯ä»¥è¿æ¥åˆ°è®¾å¤‡
- [ ] æ—¥å¿—è¾“å‡ºæ­£å¸¸

## ğŸ“– ä¸‹ä¸€æ­¥

âœ… å®‰è£…å®Œæˆåï¼Œè¯·é˜…è¯» [å¿«é€Ÿå¼€å§‹](03-å¿«é€Ÿå¼€å§‹.md) æ–‡æ¡£ã€‚